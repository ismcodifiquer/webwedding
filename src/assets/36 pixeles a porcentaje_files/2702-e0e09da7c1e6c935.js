!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="cabdb350-6aff-4d08-be2f-e658f74e684d",e._sentryDebugIdIdentifier="sentry-dbid-cabdb350-6aff-4d08-be2f-e658f74e684d")}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2702],{6741:function(e,t,n){n.d(t,{M:function(){return h}});var a=n(97458),i=n(820),r=n(52983),l=n(31737),s=n(14338),o=n(70210),u=n(46129),c=n(87552),d=n(48369),m=n(11556),_=n(73350),f=n(78398),g=n(38474);let h=e=>{let{searchValue:t,setSearchValue:n,onSearchSubmit:h,onSearchClear:x,isLoading:p,placeholder:v}=e,[y,b]=(0,r.useState)(!1),z=(0,l.useTranslations)("article.mediaSheet"),j=(0,r.useCallback)(e=>{n(e.target.value),b(!1)},[n,b]),w=(0,r.useCallback)(()=>{x(),b(!1)},[x,b]),k=(0,r.useCallback)(()=>{h(),b(!0)},[h,b]);return(0,a.jsxs)(d.G,{size:"default",wrapperClass:"pl-md",children:[(0,a.jsx)(d.G.LeftAttribution,{children:(0,a.jsx)(m.Z,{color:"light",className:"mt-[1px]",children:(0,a.jsx)(i.G,{icon:u.faMagnifyingGlass,size:"sm"})})}),(0,a.jsx)(d.G.Input,{placeholder:null!=v?v:z("searchForMedia"),isMobileStyle:!1,isMobileUserAgent:!1,value:t,onChange:j,onKeyDown:e=>{c.t.isEnterKeyWithoutShift(e)&&k()}}),(0,a.jsx)(d.G.RightAttribution,{children:p?(0,a.jsx)("div",{className:"mr-xs flex h-[32px] w-[32px] items-center justify-center",children:(0,a.jsx)(_.$,{})}):y?(0,a.jsx)(f.Z,{icon:o.YI,size:"small",pill:!0,extraCSS:"mr-xs",onClick:w}):(0,a.jsx)(g.Z,{icon:s.eF,size:"small",pill:!0,extraCSS:"mr-xs",onClick:k,variant:"primary",disabled:""===t})})]})}},6188:function(e,t,n){n.d(t,{$:function(){return x},L:function(){return p}});var a=n(97458),i=n(81993),r=n(74512),l=n(33392),s=n(52983),o=n(53541),u=n(58030),c=n(96339),d=n(96299),m=n(89782),_=n(32607);let f=e=>{var t,n,a,i;return e.length>0&&e[0].article_info?{title:e[0].article_info.title||"",suggested_sections:(null===(t=e[0].article_info)||void 0===t?void 0:t.suggested_sections)||[],audience:(null===(n=e[0].article_info)||void 0===n?void 0:n.audience)||"anyone",read_time:e[0].article_info.read_time,emphasize_sources:null!==(a=e[0].article_info.emphasize_sources)&&void 0!==a&&a,num_sections:e.length,should_index:null!==(i=e[0].should_index)&&void 0!==i&&i}:null},g={article:[],heroSection:void 0,isLoading:!1,inFlight:!1,inFlightLatest:!1,currentlyStreamingSection:void 0,socialStats:{forkCount:0,likeCount:0,viewCount:0,userLikes:!1},threadMetadata:{rwToken:void 0,contextUUID:void 0,frontendContextUUID:void 0,title:void 0,first_query:void 0,focus:void 0,author_id:void 0,author_username:void 0,author_image:void 0,parent_info:void 0,mode:void 0,personalized:!1,collection:void 0,thread_access:0,thread_url_slug:void 0,updated_datetime:void 0,expiry_time:void 0,privacy_state:d.Jr.NONE},articleMetadata:{title:void 0,suggested_sections:[],audience:"anyone",read_time:0,emphasize_sources:!1,num_sections:0,should_index:!1},articleMedia:[],articleWebResults:[],articleLocalState:{isEditModeEnabled:!1,setEditModeEnabled:()=>void 0,isCreating:!1,setIsCreating:()=>void 0,isTitleVisible:!0,setTitleVisible:()=>void 0,clickedImage:null,setClickedImage:()=>void 0,clickedImageIndex:0,isRewritingSection:!1,setRewritingSection:()=>void 0}},h=(0,s.createContext)(g),x=e=>{var t,n;let{children:d}=e,[g,x]=(0,s.useState)(!1),[p,v]=(0,s.useState)(!1),[y,b]=(0,s.useState)(null),[z,j]=(0,s.useState)(!0),[w,k]=(0,s.useState)(!1),D=(0,i.NL)(),I=(0,o.useSearchParams)(),C=null==I?void 0:I.get("newFrontendContextUUID"),U=(0,o.useParams)(),S=Array.isArray(null==U?void 0:U.slug)?U.slug[0]:null==U?void 0:U.slug,N=Array.isArray(C)?null:null!=C?C:D.getQueryData(["article-slug",S]),R=(0,s.useCallback)(async(e,t)=>{let{queryKey:n}=e,[,{frontend_context_uuid:a}]=n;return t||a?!a||t?await (0,u.NM)(t):D.getQueryData(["articleResults",{frontend_context_uuid:a}])||(_.Tb("[ArticleResultsProvider]: no data in cache for frontend_context_uuid: ".concat(a)),[]):(_.Tb("[ArticleResultsProvider]: both slug and frontend_context_uuid are undefined. queryKey: [".concat(n)),[])},[D]),{data:T}=(0,r.a)({queryKey:["articleResults",{frontend_context_uuid:N}],queryFn:e=>R(e,S),refetchOnMount:!0,placeholderData:l.Wk,select:e=>({inFlight:e.some(e=>"pending"===e.status),inFlightLatest:e.length>0&&"pending"===e[e.length-1].status})}),M=null!==(t=null==T?void 0:T.inFlight)&&void 0!==t&&t,E=null!==(n=null==T?void 0:T.inFlightLatest)&&void 0!==n&&n,{data:P}=(0,r.a)({queryKey:["articleResults",{frontend_context_uuid:N}],queryFn:e=>R(e,S),refetchOnMount:!0,placeholderData:l.Wk,select:e=>e.find(e=>"pending"===e.status&&e.backend_uuid)}),{data:A,isLoading:F}=(0,r.a)({enabled:!M,queryKey:["articleResults",{frontend_context_uuid:N}],queryFn:e=>R(e,S),refetchOnMount:!0,placeholderData:l.Wk}),{data:W}=(0,r.a)({queryKey:["articleResults",{frontend_context_uuid:N}],queryFn:e=>R(e,S),refetchOnMount:!0,placeholderData:l.Wk,select:e=>{var t;if(!e||0===e.length||"pending"===e[0].status)return null;let n=null===(t=e[0])||void 0===t?void 0:t.social_info;return n||(0,c.OR)(c.Dv),(0,c.OR)(n)}}),{data:q}=(0,r.a)({queryKey:["articleResults",{frontend_context_uuid:N}],queryFn:e=>R(e,S),placeholderData:l.Wk,refetchOnMount:!0,select:c.BX}),{data:Z}=(0,r.a)({queryKey:["articleResults",{frontend_context_uuid:N}],queryFn:e=>R(e,S),placeholderData:l.Wk,refetchOnMount:!0,select:f}),K=(0,s.useMemo)(()=>{let e=[];return null==A||A.forEach(t=>{var n,a;if("media-only"===t.article_info.layout){let a=null!==(n=t.article_info.user_selected_media_items)&&void 0!==n?n:[],i=null==a?void 0:a.filter(e=>"image"===e.medium);e.push(...i)}else{let n=null!==(a=null==t?void 0:t.media_items)&&void 0!==a?a:[];n.length>0&&"text"!=t.article_info.layout&&"image"===n[0].medium&&e.push(n[0])}}),e},[A]),Q=(0,s.useMemo)(()=>{if(!y)return 0;let e=K.findIndex(e=>(null==e?void 0:e.image)===(null==y?void 0:y.image));return e>-1?e:0},[y,K]),O=(0,s.useMemo)(()=>{let e=new Map;return A&&0!==A.length?(null==A||A.forEach(t=>{let n=(0,m.EH)(t);(null==n?void 0:n.web_results)&&n.web_results.forEach(t=>{e.has(t.url)?e.get(t.url).count+=1:e.set(t.url,{...t,count:1})})}),Array.from(e.values()).sort((e,t)=>t.count-e.count).map(e=>({...e,count:void 0}))):[]},[A]);return(0,a.jsx)(h.Provider,{value:{article:null!=A?A:[],isLoading:F,heroSection:null==A?void 0:A[0],lastSection:null==A?void 0:A[A.length-1],socialStats:W,inFlight:M,inFlightLatest:E,currentlyStreamingSection:P,threadMetadata:null!=q?q:(0,c.BX)([]),articleMetadata:null!=Z?Z:f([]),articleLocalState:{isEditModeEnabled:g,setEditModeEnabled:x,isTitleVisible:z,setTitleVisible:j,isCreating:p,setIsCreating:v,clickedImage:y,setClickedImage:b,clickedImageIndex:Q,isRewritingSection:w,setRewritingSection:k},articleMedia:K,articleWebResults:O},children:d})},p=()=>{let e=(0,s.useContext)(h);if(!e)throw Error("useArticleResults must be used within ArticleResultsContext");return e}},13487:function(e,t,n){n.d(t,{v:function(){return A}});var a=n(97458),i=n(52983),r=n(6188),l=n(820),s=n(31737),o=n(56188),u=n(72488),c=n(74807),d=n(29079),m=n(6741),_=n(18661),f=n(25929),g=n(11556),h=n(32607);let x=e=>{let{isOpen:t,onClose:n,onAddProduct:i,sectionTitle:r,section:l}=e,o=(0,s.useTranslations)("article.productSheet");return(0,a.jsx)(_.Z,{isOpen:t,variant:"side-sheet",onClose:n,title:o("title"),subtitle:r,children:(0,a.jsx)(p,{section:l,onAddProduct:i})})},p=e=>{let{section:t,onAddProduct:n}=e,[r,l]=(0,i.useState)(!1),[o,u]=(0,i.useState)(""),[c,_]=(0,i.useState)([]),g=(0,s.useTranslations)("article.productSheet"),{searchShoppingForQuery:h}=(0,d.Z)();return(0,a.jsxs)("div",{children:[(0,a.jsx)(m.M,{onSearchSubmit:()=>{t.backend_uuid&&(l(!0),h({query:o,sectionUUID:t.backend_uuid,onSuccessCallback:e=>{_(e),l(!1)}}))},searchValue:o,setSearchValue:u,onSearchClear:()=>{u(""),_([])},placeholder:g("searchPlaceholder"),isLoading:r}),(0,a.jsx)("div",{className:"grid auto-rows-min grid-cols-3 gap-md py-md",children:r?(0,a.jsx)(a.Fragment,{children:Array.from({length:3}).map((e,t)=>(0,a.jsxs)("div",{className:"flex flex-col gap-md",children:[(0,a.jsx)(f.ZP,{variant:"offset",className:"aspect-square animate-pulse rounded-md"}),(0,a.jsxs)("div",{className:"flex flex-col gap-sm",children:[(0,a.jsx)(f.ZP,{variant:"offset",className:"h-4 w-4/5 animate-pulse rounded-full"},t),(0,a.jsx)(f.ZP,{variant:"offset",className:"h-4 w-2/5 animate-pulse rounded-full"},t)]})]},"loading-article-product-".concat(t)))}):c.map(e=>(0,a.jsx)(v,{widgetSearchResult:e,onClick:()=>n(e)},e.url))})]})},v=e=>{let{widgetSearchResult:t,onClick:n}=e,i=c.BO.safeParse(t.meta_data);if(!i.success)return h.Tb("Invalid widget data",{extra:{widgetSearchResult:t}}),null;let r=i.data;return(0,a.jsx)(f.ZP,{className:"group relative cursor-pointer duration-150 active:scale-[0.99]",onClick:n,children:(0,a.jsxs)("div",{className:"relative flex flex-col items-center gap-sm",children:[r.image_url&&(0,a.jsx)(o.W,{className:"pointer-events-none w-full !rounded-md shadow-sm group-hover:opacity-70",src:r.image_url}),(0,a.jsxs)("div",{className:"flex w-full flex-col justify-start gap-xs",children:[r.name&&(0,a.jsx)(g.Z,{variant:"baseSemi",className:"leading-tight",children:r.name}),r.num_reviews&&r.rating&&(0,a.jsx)(u.D,{reviewCount:r.num_reviews,rating:r.rating}),(0,a.jsx)(g.Z,{variant:"small",children:r.price})]})]})})};var y=n(80937);let b=e=>{let{section:t,sectionTitle:n,onAddProduct:r}=e,[o,u]=(0,i.useState)(!1),c=(0,s.useTranslations)("article");return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"flex items-center justify-center",children:(0,a.jsxs)(f.ZP,{className:"group relative w-full cursor-pointer py-md duration-150 active:scale-[0.99]",onClick:()=>{u(!0)},children:[(0,a.jsx)("div",{className:"pointer-events-none absolute -inset-x-sm inset-y-sm scale-[0.98] rounded-md bg-offset opacity-0 duration-150 group-hover:scale-100 group-hover:opacity-100 dark:bg-offsetDark"}),(0,a.jsxs)("div",{className:"relative flex items-center gap-md",children:[(0,a.jsx)(f.ZP,{variant:"offsetPlus",className:"pointer-events-none flex !size-[65px] items-center justify-center !rounded-md text-textOff shadow-sm dark:text-textOffDark",children:(0,a.jsx)(l.G,{icon:y.faPlus})}),(0,a.jsx)("div",{className:"flex flex-1 flex-col gap-xs",children:(0,a.jsx)(g.Z,{color:"light",variant:"smallBold",children:c("productSheet.title")})})]})]})}),(0,a.jsx)(x,{isOpen:o,section:t,sectionTitle:n,onClose:()=>{u(!1)},onAddProduct:e=>{u(!1),r(e)}})]})};var z=n(55814),j=n(1809),w=n(10785),k=n(33326),D=n(46563),I=n(78626),C=n(382),U=n(38474),S=n(97437);let N=e=>{let{item:t,canEdit:n,isFirst:i,isLast:r,onDelete:l,variant:s="list"}=e,o=t.id,{openModal:u}=(0,j.X)(),c=()=>{let e=document.querySelector("[data-widget-id='".concat(o,"']"));if(e){let t=e.getBoundingClientRect().top+window.scrollY-60;window.scrollTo({top:t,behavior:"smooth"})}};return"list"===s?(0,a.jsx)(R,{canEdit:n,item:t,onClick:c,onDelete:null!=l?l:()=>{}}):(0,a.jsx)(M,{canEdit:n,item:t,onClick:c})},R=e=>{let{onClick:t,onDelete:n,item:i,canEdit:r}=e,{isMobileStyle:l}=(0,D.d)(),{image_url:c,num_reviews:d,rating:m}=i,_=(0,s.useTranslations)("shop");return(0,a.jsxs)(f.ZP,{className:"group relative cursor-pointer py-md duration-150 active:scale-[0.99]",onClick:t,children:[(0,a.jsx)("div",{className:"pointer-events-none absolute -inset-x-sm inset-y-sm scale-[0.98] rounded-md bg-offset opacity-0 duration-150 group-hover:scale-100 group-hover:opacity-100"}),(0,a.jsxs)("div",{className:"gap-m just relative flex w-full items-center gap-md duration-150 group-hover:opacity-70",children:[c&&(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(o.W,{className:"pointer-events-none relative !size-[60px] shrink-0 !rounded-md after:absolute after:inset-0 after:rounded-[inherit] after:border after:border-black/10 after:content-['']",src:c}),(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-offset/50 opacity-0 duration-150 group-hover:opacity-100",children:(0,a.jsx)("div",{className:"aspect-square shrink-0 items-center justify-center gap-xs rounded-full bg-background shadow-md duration-150 md:aspect-auto md:w-auto md:px-[10px] md:py-xs",children:(0,a.jsx)(g.Z,{className:"flex items-center gap-sm whitespace-nowrap",variant:l?"small":"tiny",children:(0,a.jsx)("span",{className:"hidden md:inline-flex",children:_("view")})})})})]}),(0,a.jsxs)("div",{className:"flex flex-1 flex-col gap-xs",children:[(0,a.jsx)(g.Z,{variant:"smallBold",className:"line-clamp-2 leading-tight",children:i.name}),(0,a.jsxs)(I.Root,{className:"gap-xs text-textOff",delimiter:"",children:[(0,a.jsx)(I.Item,{id:"price",children:(0,a.jsx)(g.Z,{variant:"tiny",color:"light",children:i.price})}),i.variants&&i.variants[0].compare_at_price&&(0,a.jsx)(I.Item,{id:"originalPrice",children:(0,a.jsx)(g.Z,{variant:"tiny",color:"light",className:"line-through opacity-70",children:i.variants[0].compare_at_price})}),m&&(0,a.jsx)(I.Item,{id:"rating",children:(0,a.jsx)(u.D,{reviewCount:d,rating:m,size:"2xs",textVariant:"tiny",className:"mb-[2px]",variant:"truncated"})})]})]}),r&&(0,a.jsx)(T,{onDelete:n})]})]})},T=e=>{let{onDelete:t}=e,n=(0,s.useTranslations)("article"),{isMobileStyle:r}=(0,D.d)(),[l,o]=(0,i.useState)(!1);return(0,a.jsx)(C.G,{items:[{text:n("section.remove"),icon:k.$,destructive:!0,onClick:e=>{t(),e.stopPropagation()}}],isMobileStyle:r,isOpen:l,onClose:()=>{o(!1)},children:(0,a.jsx)(U.Z,{icon:w.faEllipsis,extraCSS:"",size:"tiny",pill:!0,onClick:e=>{o(!0),e.stopPropagation()}})})},M=e=>{let{onClick:t,item:n,canEdit:i}=e,{image_url:r,num_reviews:l,rating:s}=n;return(0,a.jsx)(f.ZP,{variant:"offset",bgHover:"offsetPlus",className:"group relative flex shrink-0 cursor-pointer rounded-lg px-sm py-sm duration-150 active:scale-[0.99]",onClick:t,children:(0,a.jsxs)("div",{className:"relative flex w-full flex-col items-start gap-sm",children:[r&&(0,a.jsx)("div",{className:"aspect-square w-full",children:(0,a.jsx)(o.W,{className:"pointer-events-none !rounded-md shadow-sm after:absolute after:inset-0 after:rounded-[inherit] after:border after:border-black/5 after:content-[''] group-hover:opacity-70",src:r})}),(0,a.jsxs)("div",{className:"flex w-full flex-1 flex-col gap-xs",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(g.Z,{variant:"smallBold",children:n.price}),(0,a.jsx)(g.Z,{variant:"small",color:"light",className:"line-clamp-2",children:n.name})]}),(0,a.jsx)("div",{className:"h-full flex-1"}),(0,a.jsxs)(g.Z,{variant:"tiny",color:"light",className:"flex items-center gap-xs",children:[(0,a.jsx)(S.D,{size:12,className:"inline-flex shrink-0",domain:n.merchant_info.merchant_domain}),(0,a.jsx)("span",{className:"line-clamp-1",children:n.merchant})]}),s&&(0,a.jsx)(u.D,{size:"2xs",reviewCount:l,rating:s,textVariant:"tiny",variant:"truncated"})]})]})})};var E=n(51865),P=n.n(E);let A=e=>{let{widgets:t,section:n,sectionTitle:l,onAddProduct:s,className:o,title:u}=e,{articleLocalState:m}=(0,r.L)(),{removeWidget:_}=(0,d.Z)(),{trackEvent:x}=(0,z.WS)(),p=(0,i.useMemo)(()=>t.map(e=>{let t=c.id.safeParse(e.meta_data);if(!t.success)return h.Tb("Invalid widget data",{extra:{widget:e}}),null;let n=t.data;return"ShopifyWidget"===n.object?n:null}).filter(Boolean),[t]),v=(0,i.useCallback)(e=>{(null==n?void 0:n.backend_uuid)&&(_({sectionUUID:n.backend_uuid,urlToRemove:e}),x("remove widget",{entryUUID:n.backend_uuid,source:"page",url:e}))},[_,null==n?void 0:n.backend_uuid,x]),y=(0,i.useMemo)(()=>p.map((e,n)=>e&&"ShopifyWidget"===e.object?(0,a.jsx)(N,{item:e,canEdit:m.isEditModeEnabled,isFirst:0===n,isLast:n===t.length-1,onDelete:()=>v(e.url)},e.id):null).filter(Boolean),[p,m.isEditModeEnabled,v,t.length]);return 0===p.length?null:(0,a.jsx)("div",{children:(0,a.jsxs)(f.ZP,{variant:"offset",className:P()("flex flex-col rounded-lg px-md",o),children:[u&&(0,a.jsx)(g.Z,{className:"-mb-sm mt-sm",variant:"section-title",children:u}),(0,a.jsxs)(f.ZP,{className:"flex flex-col divide-y",children:[y,m.isEditModeEnabled&&n&&(0,a.jsx)(b,{section:n,sectionTitle:l,onAddProduct:s})]})]})})}},74807:function(e,t,n){n.d(t,{BO:function(){return z},id:function(){return w}});var a=n(5394);let i=a.z.object({name:a.z.string(),value:a.z.array(a.z.union([a.z.string(),a.z.number(),a.z.null(),a.z.undefined()]))}),r=a.z.object({name:a.z.string(),reportDate:a.z.array(a.z.string(),a.z.null()),item:a.z.array(i)}),l=a.z.object({requestId:a.z.string(),categories:a.z.array(r)}),s=a.z.array(l),o=a.z.object({type:a.z.literal("factset_fundamentals"),data:s}),u=a.z.array(a.z.object({currency:a.z.string(),date:a.z.string(),requestId:a.z.string(),price:a.z.number()})),c=a.z.object({type:a.z.literal("factset_global_prices"),data:u}),d=a.z.object({requestId:a.z.string(),asOfDate:a.z.string().optional(),currency:a.z.string()}).passthrough(),m=a.z.array(d),_=a.z.object({type:a.z.literal("factset_company_fundamentals"),data:m}),f=a.z.discriminatedUnion("type",[c,o,_]),g=a.z.object({is_attachment:a.z.boolean(),is_image:a.z.boolean(),is_code_interpreter:a.z.boolean(),is_knowledge_card:a.z.boolean(),is_map:a.z.boolean(),is_navigational:a.z.boolean(),is_widget:a.z.boolean()}),h=a.z.object({name:a.z.string(),snippet:a.z.string(),timestamp:a.z.string(),url:a.z.string(),meta_data:a.z.record(a.z.unknown()).nullable()}).and(g),x=a.z.object({object:a.z.literal("TakoWidget"),data:a.z.object({iframe:a.z.string(),url:a.z.string()})}),p=a.z.object({object:a.z.literal("TimeWidget"),data:a.z.object({time:a.z.string(),date:a.z.string(),location:a.z.string()})}),v=a.z.object({object:a.z.literal("CalculatorWidget"),data:a.z.object({expression:a.z.string(),result:a.z.number()})}),y=a.z.object({object:a.z.literal("WeatherWidget"),current:a.z.object({temp_c:a.z.number().optional(),temp_f:a.z.number().optional(),wind_mph:a.z.number().optional(),wind_kph:a.z.number().optional(),wind_dir:a.z.string().optional(),pressure_mb:a.z.number().optional(),pressure_in:a.z.number().optional(),precip_mm:a.z.number().optional(),precip_in:a.z.number().optional(),humidity:a.z.number().optional(),cloud:a.z.number().optional(),condition:a.z.object({text:a.z.string(),icon:a.z.string(),code:a.z.string()}).optional()}),location:a.z.object({name:a.z.string().optional(),country:a.z.string().optional(),tz_id:a.z.string().optional(),localtime:a.z.string().optional(),region:a.z.string().optional(),is_usa:a.z.union([a.z.literal(1),a.z.literal(0)]).optional()}),forecast:a.z.array(a.z.object({dow:a.z.string().optional(),icon:a.z.string().optional(),maxtemp_c:a.z.number().optional(),maxtemp_f:a.z.number().optional(),mintemp_c:a.z.number().optional(),mintemp_f:a.z.number().optional(),hour:a.z.array(a.z.object({temp_c:a.z.number(),temp_f:a.z.number(),time:a.z.string()}))}))}),b=a.z.array(a.z.object({src:a.z.string(),variants:a.z.array(a.z.string()),width:a.z.number().nullable(),height:a.z.number().nullable()})),z=a.z.object({object:a.z.literal("ShopifyWidget"),id:a.z.string(),url:a.z.string(),name:a.z.string(),description:a.z.string().nullable(),rating:a.z.number().nullable(),num_reviews:a.z.number().nullable(),currency_code:a.z.string().nullable(),images:b,options:a.z.array(a.z.object({name:a.z.string(),values:a.z.array(a.z.string())})).nullable(),variants:a.z.array(a.z.object({id:a.z.string(),title:a.z.string(),price:a.z.string().nullable(),compare_at_price:a.z.string().nullable(),option1:a.z.string().nullable(),option2:a.z.string().nullable(),option3:a.z.string().nullable()})).nullable(),merchant_info:a.z.object({merchant_name:a.z.string(),merchant_domain:a.z.string(),total_reviews:a.z.number().nullable(),average_rating:a.z.number().nullable(),logo_url:a.z.string().nullable()}),merchant:a.z.string().nullable(),image_url:a.z.string().nullable(),price:a.z.string().nullable(),client:a.z.string(),is_card:a.z.boolean(),review_summary:a.z.object({summary:a.z.string(),review_quality_score:a.z.number(),pros_detailed:a.z.array(a.z.object({label:a.z.string(),description:a.z.string()})).optional(),cons_detailed:a.z.array(a.z.object({label:a.z.string(),description:a.z.string()})).optional(),pros:a.z.array(a.z.string()),cons:a.z.array(a.z.string()),key_features:a.z.array(a.z.string()),review_search_results:a.z.array(h),buy_if:a.z.string().optional()}).nullable()}),j=a.z.object({object:a.z.literal("FinanceWidget"),data:a.z.array(f)}),w=a.z.discriminatedUnion("object",[y,x,p,v,z,j])},75004:function(e,t,n){n.d(t,{SL:function(){return G},qy:function(){return L},OT:function(){return O}});var a=n(97458),i=n(52983),r=n(59842),l=n(17142),s=n(12722);let o=e=>{let{graphData:t}=e,[n,{height:i}]=(0,r.Z)();return(0,a.jsx)(l.s,{children:(0,a.jsx)(s.E.div,{animate:i>0?{height:i}:{},transition:{type:"spring",bounce:.2,duration:.2},children:(0,a.jsx)("div",{ref:n,children:(0,a.jsx)("img",{src:t.url,alt:"Graph",className:"mx-auto block h-auto max-w-[70%]"})})})})};var u=n(86231),c=n.n(u),d=n(74807),m=n(77954),_=n(32607);let f=c()(()=>Promise.all([n.e(7094),n.e(5969),n.e(5530)]).then(n.bind(n,95530)).then(e=>e.WeatherWidget),{loadableGenerated:{webpack:()=>[95530]},loading:()=>(0,a.jsx)(m.Z,{size:"large"})}),g=c()(()=>n.e(8998).then(n.bind(n,58998)).then(e=>e.TimeWidget),{loadableGenerated:{webpack:()=>[58998]},loading:()=>(0,a.jsx)(m.Z,{size:"small"})}),h=c()(()=>n.e(7160).then(n.bind(n,97160)).then(e=>e.CalculatorWidget),{loadableGenerated:{webpack:()=>[97160]},loading:()=>(0,a.jsx)(m.Z,{size:"small"})}),x=c()(()=>n.e(2347).then(n.bind(n,62347)).then(e=>e.TakoWidget),{loadableGenerated:{webpack:()=>[62347]},loading:()=>(0,a.jsx)(m.Z,{size:"large"})}),p=c()(()=>Promise.resolve().then(n.bind(n,16941)).then(e=>e.ShopifyWidget),{loadableGenerated:{webpack:()=>[16941]},loading:()=>(0,a.jsx)(m.Z,{size:"large"})}),v=c()(()=>Promise.all([n.e(7094),n.e(4780),n.e(6474),n.e(5037)]).then(n.bind(n,85037)).then(e=>e.default),{loadableGenerated:{webpack:()=>[85037]},loading:()=>(0,a.jsx)(m.Z,{size:"large"})}),y=e=>{let{widgetData:t,menuItems:n,contextUUID:i}=e,r=d.id.safeParse(t.meta_data);if(!r.success)return _.Tb("Invalid widget data",{extra:{widgetData:t}}),null;let s=r.data,o=s.object;switch(o){case"WeatherWidget":return(0,a.jsx)(l.s,{menuItems:n,variant:"noChrome",children:(0,a.jsx)(f,{...s})});case"TimeWidget":return(0,a.jsx)(l.s,{menuItems:n,children:(0,a.jsx)(g,{...s})});case"CalculatorWidget":return(0,a.jsx)(l.s,{menuItems:n,children:(0,a.jsx)(h,{...s})});case"TakoWidget":return(0,a.jsx)(l.s,{menuItems:n,children:(0,a.jsx)(x,{...s})});case"ShopifyWidget":return(0,a.jsx)(l.s,{menuItems:n,variant:"noChrome",children:(0,a.jsx)(p,{item:s,contextUUID:i})});case"FinanceWidget":return(0,a.jsx)(l.s,{menuItems:n,variant:"noChrome",children:(0,a.jsx)(v,{...s})});default:return _.Tb(Error("No PanelComponent found for livePanelType: ".concat(o))),null}};var b=n(31737),z=n(53541),j=n(55814),w=n(96339),k=n(820),D=n(45594),I=n(24819),C=n.n(I),U=n(4403);let S=e=>e.replace(/[.*+\-?^${}()|[\]\\]/g,"\\$&");var N=n(74650),R=n(11556),T=n(51865),M=n.n(T);let E=e=>{let{icon:t,name:n,value:r,entities:s,onEntityClick:o}=e,{inFlight:u}=(0,w.a0)(),c=(null==s?void 0:s.length)>0,d=(0,i.useMemo)(()=>c?RegExp("(".concat(s.map(S).join("|"),")"),"g"):null,[c,s]),m=(0,i.useMemo)(()=>r.split(d),[r,d]),_=(0,i.useCallback)(e=>{u||o(e)},[u,o]),f=M()("underline-thickness-thin underline-offset-sm cursor-pointer decoration-textOff/60 decoration-dotted hover:text-super hover:decoration-super dark:decoration-textOffDark/60 dark:hover:text-superDark dark:hover:decoration-superDark group transition-colors duration-200 ease-in-out",{underline:!u}),g=(0,i.useCallback)(e=>{let{content:t}=e,n=t.startsWith("http://")||t.startsWith("https://")?t:"https://".concat(t);return(0,a.jsxs)(C(),{href:n,target:"_blank",rel:"noopener noreferrer",className:f,children:[t,(0,a.jsx)(R.Z,{className:"ml-xs inline",variant:"tiny",children:(0,a.jsx)(k.G,{className:"transition-colors duration-200 ease-in-out group-hover:text-super dark:group-hover:text-superDark",icon:N.t3})})]})},[f]),h=(0,i.useMemo)(()=>m.map(e=>c&&s.includes(e)?(0,a.jsx)("span",{className:f,onClick:()=>_(e),children:e},"".concat(e,"-").concat(Math.random())):(0,a.jsx)(U.Z,{fallback:(0,a.jsx)("div",{children:e}),children:(0,a.jsx)(D.Z,{options:{render:g},children:e})},"".concat(e,"-").concat(Math.random()))),[m,c,s,f,g,_]);return(0,a.jsx)(l.s.Item,{icon:t,name:n,value:h},n)};var P=n(53812),A=n(62336),F=n(89782),W=n(38474);let q=i.memo(e=>{let{data:t,isReadonly:n,submit:o}=e,{title:u,subtitle:c,attributes:d,image_url:m,source_url:_}=t,{trackEvent:f}=(0,j.WS)(),{threadMetadata:g}=(0,w.a0)(),h=g.frontendContextUUID,x=(0,z.useRouter)(),[p,v]=(0,i.useState)(3),y=d.length,k=p===y,D=d.length>3,I=(0,b.useTranslations)("panel"),{menuItems:C}=(0,l.u)(),U=(0,i.useCallback)(()=>{f("click toggle on knowledge card",{newState:k?"collapsed":"expanded"}),v(e=>3===e?y:3)},[f,k,y]),[S,{height:N}]=(0,r.Z)(),R=(0,F.Mp)(),T=(0,i.useCallback)(e=>{if(o({fork:n,rawQuery:e,collection:null,newFrontendContextUUID:n?R:null,existingFrontendContextUUID:n?null:h,promptSource:"user",querySource:"entity_link"}),n){let t=new URLSearchParams({q:e,newFrontendContextUUID:R}),n=new URL(window.location.href);n.pathname="search",n.search=t.toString();let a=n.toString();x.push(a)}},[o,n,R,h,x]);return(0,i.useEffect)(()=>{f("entry panel shown",{})},[f]),(0,a.jsx)("div",{className:"relative",children:(0,a.jsx)(s.E.div,{animate:N>0?{height:N}:{},transition:{type:"spring",bounce:.2,duration:.2},className:"overflow-hidden",children:(0,a.jsxs)("div",{ref:S,className:"relative",children:[(0,a.jsx)("div",{className:"flex items-end justify-between",children:(0,a.jsx)(l.s.Title,{title:u,subtitle:c,image_url:m,href:_,children:(0,a.jsx)("div",{className:"flex items-start",children:(0,a.jsxs)("div",{className:"flex items-center gap-sm",children:[C&&(null==C?void 0:C.length)>0&&(0,a.jsx)(l.s.Menu,{menuItems:C}),D&&(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsx)(W.Z,{variant:"common",text:I(k?"less":"more"),size:"tiny",pill:!0,onClick:U,icon:k?A.mT:P.pt})})]})})})}),(0,a.jsx)("div",{className:"grid grid-cols-[auto,1fr] gap-x-sm gap-y-sm md:gap-x-md",children:d.slice(0,p).map(e=>(0,a.jsx)(E,{icon:e.icon,name:e.name,value:e.value,entities:e.key_entities,onEntityClick:T},e.name))})]})})})}),Z=e=>{let{knowledgePanelData:t,summaryData:n,isReadonly:i,submit:r,menuItems:s}=e;if(!t&&!n)return null;let o=t?function(e){let{meta_data:{title:t,subtitle:n,attributes:a,image_url:i},url:r,name:l}=e;return{title:t,subtitle:n,attributes:a,image_url:i,source_url:r}}(t):function(e){let{title:t,subtitle:n,bullet_points:a}=e;return{title:t,subtitle:n,attributes:a.map(e=>{let{Descriptor:t,bullet_point:n}=e;return{icon:"",name:t,value:n,key_entities:[]}}),image_url:"",source_url:""}}(n);return(0,a.jsx)(l.s,{menuItems:s,children:(0,a.jsx)(q,{data:o,submit:r,isReadonly:i})})};var K=n(25929);function Q(e){return e&&"is_widget"in e&&!0===e.is_widget}function O(e){return e&&Q(e)&&"ShopifyWidget"===e.meta_data.object}function L(e){return e.some(e=>O(e))}let G=e=>{let{data:t,submit:n,isReadonly:i=!1,menuItems:r,contextUUID:l}=e;return(0,a.jsxs)(K.ZP,{children:[Q(t)&&(0,a.jsx)(y,{widgetData:t,menuItems:null!=r?r:[],contextUUID:l}),t&&"is_knowledge_card"in t&&t.is_knowledge_card&&(0,a.jsx)(Z,{knowledgePanelData:t,summaryData:null,submit:n,isReadonly:i,menuItems:null!=r?r:[]}),"is_code_interpreter"in t&&!0===t.is_code_interpreter&&t.is_image&&(0,a.jsx)(o,{graphData:t})]})}},4403:function(e,t,n){var a=n(97458),i=n(52983);class r extends i.Component{static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(e,t){console.log({error:e,errorInfo:t})}render(){if(this.state.hasError){var e;return(null===(e=this.props)||void 0===e?void 0:e.fallback)?this.props.fallback:(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{children:"Oops, there is an error!"}),(0,a.jsx)("button",{type:"button",onClick:()=>this.setState({hasError:!1}),children:"Try again?"})]})}return this.props.children}constructor(e){super(e),this.state={hasError:!1}}}t.Z=r},29079:function(e,t,n){n.d(t,{Z:function(){return p}});var a=n(81993),i=n(22696),r=n(52983),l=n(39294),s=n(55814),o=n(64038),u=n(67937),c=n(61061),d=n(1809),m=n(12258),_=n(6188),f=n(5394);let g=f.z.object({url:f.z.string().optional(),fields:f.z.record(f.z.union([f.z.string(),f.z.number()])).optional(),success:f.z.boolean().optional(),status:f.z.string(),rate_limited:f.z.boolean().optional()});var h=n(94568),x=n(96299);let p=()=>{let{threadMetadata:e,lastSection:t}=(0,_.L)(),{openModal:n}=(0,d.X)(),{decrementCreateLimit:f}=(0,m.h)(),p=(0,c.nO)(),v=(0,a.NL)(),y=(0,l.O)(),{removeItemFromSidebar:b}=(0,o.f)(),{trackEvent:z}=(0,s.WS)(),{mutate:j}=(0,i.D)({mutationKey:["updateArticleSectionTitle",e.thread_url_slug],mutationFn:t=>{let{title:n,backendUUID:a}=t;return(0,u.TF)(a,n,e.rwToken)},onMutate:async e=>{let{title:n,backendUUID:a}=e;await v.cancelQueries({queryKey:["articleResults",{frontend_context_uuid:null==t?void 0:t.frontend_context_uuid}],exact:!1}),v.setQueryData(["articleResults",{frontend_context_uuid:null==t?void 0:t.frontend_context_uuid}],e=>e.map(e=>e.backend_uuid===a?{...e,article_info:{...e.article_info,title:n,has_changed_title:!0}}:e))}}),{mutate:w}=(0,i.D)({mutationKey:["updateArticleSectionHeroOffset",e.thread_url_slug],mutationFn:async t=>{let{backendUUID:n,callback:a,heroOffset:i}=t,r=await (0,u.mq)(n,i,e.rwToken);return a(),r},onMutate:async e=>{let{frontendContextUUID:t,backendUUID:n,heroOffset:a}=e;await v.cancelQueries({queryKey:["articleResults",{frontend_context_uuid:t}],exact:!1}),v.setQueryData(["articleResults",{frontend_context_uuid:t}],e=>e.map(e=>e.backend_uuid===n?{...e,article_info:{...e.article_info,hero_offset:a}}:e))}}),{mutate:k}=(0,i.D)({mutationKey:["publishArticleMutation",e.thread_url_slug],mutationFn:async t=>{let{callback:n}=t;return n(),z("change page access level",{contextUUID:e.contextUUID,oldAccessLevel:x.uv.PRIVATE_READ,newAccessLevel:x.uv.PUBLIC_READ}),y(e.contextUUID,x.uv.PUBLIC_READ,e.rwToken)},onMutate:async()=>{await v.cancelQueries({queryKey:["articleResults",{frontend_context_uuid:e.frontendContextUUID}],exact:!1}),v.setQueryData(["articleResults",{frontend_context_uuid:e.frontendContextUUID}],e=>{if(!e)return;let[t,...n]=e;return[{...t,thread_access:x.uv.PUBLIC_READ},...n]})}}),{mutate:D}=(0,i.D)({mutationKey:["unpublishArticleMutation",e.thread_url_slug],mutationFn:async()=>(z("change page access level",{contextUUID:e.contextUUID,oldAccessLevel:x.uv.PUBLIC_READ,newAccessLevel:x.uv.PRIVATE_READ}),y(e.contextUUID,x.uv.PRIVATE_READ,e.rwToken)),onMutate:async()=>{await v.cancelQueries({queryKey:["articleResults",{frontend_context_uuid:e.frontendContextUUID}],exact:!1}),v.setQueryData(["articleResults",{frontend_context_uuid:e.frontendContextUUID}],e=>{if(!e)return;let[t,...n]=e;return[{...t,thread_access:x.uv.PRIVATE_READ},...n]})}}),I=(0,r.useCallback)(async t=>{let{backendUUID:n}=t;if(!p){console.error("Socket is null");return}let{status:a,media_items:i}=await p.emitWithAck("search_images_for_entry",n,{read_write_token:null==e?void 0:e.rwToken});"failed"!==a&&n&&v.setQueryData(["articleResults",{frontend_context_uuid:e.frontendContextUUID}],e=>{if(e)return e.map(e=>e.backend_uuid===n?{...e,media_items:i}:e)})},[v,p,e.frontendContextUUID,null==e?void 0:e.rwToken]),C=(0,r.useCallback)(async t=>{let{backendUUID:a,imageStyle:i,customInstructions:r=null,onFailureCallback:l}=t;if(!p){console.error("Socket is null");return}let{status:s,error_code:o,media_items:u}=await p.emitWithAck("create_image_for_entry",a,{image_style:i,custom_instructions:r,read_write_token:null==e?void 0:e.rwToken});"failed"===s?"PRO_ONLY"===o?n("pricingModal",{redirectUrl:"",pitchMessage:{title:"Generate DALL-E images with Pro",description:"Upgrade to Pro to generate DALL-E images"},origin:x.FM.GENERATE_IMAGE}):l("MODERATION"===o?"Failed due to moderation. Please try a different query":"Something is wrong with image generation. Please try later."):a&&(v.setQueryData(["articleResults",{frontend_context_uuid:e.frontendContextUUID}],e=>{if(e)return e.map(e=>e.backend_uuid===a?{...e,media_items:u}:e)}),f())},[f,n,v,p,e.frontendContextUUID,null==e?void 0:e.rwToken]),{mutate:U}=(0,i.D)({mutationKey:["deleteArticle",e.thread_url_slug],mutationFn:async t=>{let{sectionUUID:n,callback:a}=t;if(!p)throw Error("No socket connection");null==a||a(),await p.emitWithAck("delete_thread_by_entry_uuid",n,{read_write_token:null==e?void 0:e.rwToken}),b(n)}}),{mutate:S}=(0,i.D)({mutationKey:["deleteSection",e.thread_url_slug],mutationFn:t=>(0,u.J1)(t,e.rwToken),onMutate:async e=>{await v.cancelQueries({queryKey:["articleResults",{frontend_context_uuid:null==t?void 0:t.frontend_context_uuid}],exact:!1}),v.setQueryData(["articleResults",{frontend_context_uuid:null==t?void 0:t.frontend_context_uuid}],t=>t.filter(t=>t.backend_uuid!==e))}}),{mutate:N}=(0,i.D)({mutationKey:["updateArticleSectionsLayout",e.thread_url_slug],mutationFn:async t=>{let{sections:n}=t;return await (0,u.l8)(n,e.rwToken)},onMutate:async e=>{let{sections:n}=e;await v.cancelQueries({queryKey:["articleResults",{frontend_context_uuid:null==t?void 0:t.frontend_context_uuid}],exact:!1}),v.setQueryData(["articleResults",{frontend_context_uuid:null==t?void 0:t.frontend_context_uuid}],e=>e.map(e=>{let t=n.find(t=>t.sectionUUID===e.backend_uuid);return t?{...e,article_info:{...e.article_info,layout:t.layout}}:e}))}}),{mutate:R}=(0,i.D)({mutationKey:["updateArticleSectionImage",e.thread_url_slug],mutationFn:t=>{let{backendUUID:n,mediaItem:a,targetIndex:i,isNewMediaItem:r}=t;return(0,u.fz)({sectionUUID:n,mediaItem:a,targetIndex:i,isNewMediaItem:r,rwToken:e.rwToken})},onMutate:async n=>{let{backendUUID:a,mediaItem:i,targetIndex:r,isNewMediaItem:l}=n;await v.cancelQueries({queryKey:["articleResults",{frontend_context_uuid:null==t?void 0:t.frontend_context_uuid}],exact:!1}),l&&v.setQueryData(["articleResults",{frontend_context_uuid:e.frontendContextUUID}],e=>e.map(e=>e.backend_uuid===a?{...e,media_items:[i,...e.media_items||[]]}:e)),v.setQueryData(["articleResults",{frontend_context_uuid:e.frontendContextUUID}],e=>{if(e)return e.map(e=>{if(e.backend_uuid!==a)return e;if("media-only"===e.article_info.layout&&e.media_items&&i.image){let t=(0,h.ud)(e.article_info.user_selected_media_items,e.media_items,i.image,r);return{...e,article_info:{...e.article_info,user_selected_media_items:t}}}if(e.media_items&&i.image){let t=(0,h.Hk)(e.media_items,i.image,r);return{...e,media_items:t}}})})}}),{mutate:T}=(0,i.D)({mutationKey:["addMediaItemToSectionSelectedImages",e.thread_url_slug],mutationFn:t=>{let{sectionUUID:n,mediaItem:a,isNewMediaItem:i}=t;return(0,u.AM)(n,a,e.rwToken,i)},onMutate:async n=>{let{sectionUUID:a,mediaItem:i,isNewMediaItem:r}=n;await v.cancelQueries({queryKey:["articleResults",{frontend_context_uuid:null==t?void 0:t.frontend_context_uuid}],exact:!1}),v.setQueryData(["articleResults",{frontend_context_uuid:e.frontendContextUUID}],e=>e?r?e.map(e=>e.backend_uuid===a?{...e,media_items:[i,...e.media_items||[]],article_info:{...e.article_info,user_selected_media_items:[...e.article_info.user_selected_media_items,i]}}:e):e.map(e=>{if(e.backend_uuid===a){var t;return{...e,article_info:{...e.article_info,user_selected_media_items:[...e.article_info.user_selected_media_items,null===(t=e.media_items)||void 0===t?void 0:t.find(e=>e.image===i.image)]}}}return e}):void 0)}}),{mutate:M}=(0,i.D)({mutationKey:["removeMediaItemFromSectionSelectedImages",e.thread_url_slug],mutationFn:t=>{let{sectionUUID:n,mediaItemImageUrl:a}=t;return(0,u.Th)(n,a,e.rwToken)},onMutate:async n=>{let{sectionUUID:a,mediaItemImageUrl:i}=n;await v.cancelQueries({queryKey:["articleResults",{frontend_context_uuid:null==t?void 0:t.frontend_context_uuid}],exact:!1}),v.setQueryData(["articleResults",{frontend_context_uuid:e.frontendContextUUID}],e=>{if(e)return e.map(e=>e.backend_uuid===a?{...e,article_info:{...e.article_info,user_selected_media_items:e.article_info.user_selected_media_items.filter(e=>e.image!==i)}}:e)})}}),{mutate:E}=(0,i.D)({mutationKey:["uploadImageToSectionMediaItems",e.thread_url_slug],mutationFn:async t=>{let{sectionUUID:n,image:a,onSuccessCallback:i,onFailureCallback:r}=t,l=await (0,u.jX)(n,a,e.rwToken),s=g.parse(l);if("failed"===s.status){r("Something went wrong. Please try later.");return}let o=new FormData;Object.entries(s.fields||{}).forEach(e=>{let[t,n]=e;o.append(t,n.toString())}),o.append("file",a);try{let e=await fetch(s.url||"",{method:"POST",body:o});if(e.ok){var c,d;let t=await e.json();if((null==t?void 0:null===(d=t.moderation)||void 0===d?void 0:null===(c=d[0])||void 0===c?void 0:c.status)==="rejected"){r("Failed due to moderation. Please try a different image"),i();return}let a=null==t?void 0:t.secure_url,l={image:a,url:a,source:a,medium:"image",thumbnail:a,image_width:null==t?void 0:t.width,image_height:null==t?void 0:t.height};i(),q({sectionUUID:n,mediaItem:l})}else r("Something went wrong. Please try later.")}catch(e){r("Something went wrong. Please try later.")}}}),{mutate:P}=(0,i.D)({mutationKey:["reorderArticleSection",e.thread_url_slug],mutationFn:t=>{let{sectionUUID:n,relativeMove:a}=t;return(0,u.M6)(e.thread_url_slug,n,a,e.rwToken)},onMutate:async n=>{let{sectionUUID:a,relativeMove:i}=n;await v.cancelQueries({queryKey:["articleResults",{frontend_context_uuid:null==t?void 0:t.frontend_context_uuid}],exact:!1}),v.setQueryData(["articleResults",{frontend_context_uuid:e.frontendContextUUID}],e=>{if(!e)return;let t=e.findIndex(e=>e.backend_uuid===a);if(-1===t)return console.error("Section not found"),e;let n=t+i;if(n<0||n>=e.length)return console.error("Invalid move"),e;let r=[...e],l=r[t];return r[t]=r[n],r[n]=l,r})}}),{mutate:A}=(0,i.D)({mutationKey:["searchMediaForQuery",e.thread_url_slug],mutationFn:async t=>{let{query:n,sectionUUID:a,onSuccessCallback:i}=t;if(!p)throw Error("No socket connection");let{status:r,media_items:l}=await p.emitWithAck("search_images_and_videos",n,{read_write_token:null==e?void 0:e.rwToken,entry_uuid:a});"failed"!==r&&i(l)}}),{mutate:F}=(0,i.D)({mutationKey:["searchShoppingForQuery",e.thread_url_slug],mutationFn:async t=>{let{query:n,sectionUUID:a,onSuccessCallback:i}=t;if(!p)throw Error("No socket connection");let{status:r,shopping_widgets:l}=await p.emitWithAck("search_shopping_for_entry",n,{read_write_token:null==e?void 0:e.rwToken,entry_uuid:a});"failed"!==r&&i(l)}}),{mutate:W}=(0,i.D)({mutationKey:["generateReviewSummaryForItem",e.thread_url_slug],mutationFn:async t=>{let{webResult:n,sectionUUID:a,onSuccessCallback:i}=t;if(!p)throw Error("No socket connection");let{status:r,search_result_with_review_summary:l}=await p.emitWithAck("generate_review_summary_for_item",n,{read_write_token:null==e?void 0:e.rwToken,entry_uuid:a});"failed"!==r&&i(l)},onMutate:async t=>{let{webResult:n,sectionUUID:a,onSuccessCallback:i}=t;await v.cancelQueries({queryKey:["articleResults",{frontend_context_uuid:e.frontendContextUUID}],exact:!1}),v.setQueryData(["articleResults",{frontend_context_uuid:e.frontendContextUUID}],e=>e.map(e=>e.backend_uuid===a?{...e,widget_data:[n,...e.widget_data||[]]}:e))}}),{mutate:q}=(0,i.D)({mutationKey:["addMediaItemToSection",e.thread_url_slug],mutationFn:t=>{let{sectionUUID:n,mediaItem:a}=t;return(0,u.vE)(n,a,e.rwToken)},onMutate:async t=>{let{sectionUUID:n,mediaItem:a}=t;await v.cancelQueries({queryKey:["articleResults",{frontend_context_uuid:e.frontendContextUUID}],exact:!1}),v.setQueryData(["articleResults",{frontend_context_uuid:e.frontendContextUUID}],e=>e.map(e=>e.backend_uuid===n?{...e,media_items:[a,...e.media_items||[]]}:e))}}),{mutate:Z}=(0,i.D)({mutationKey:["removeWidget",e.thread_url_slug],mutationFn:t=>{let{sectionUUID:n,urlToRemove:a}=t;return(0,u.UF)(n,a,e.rwToken)},onMutate:async t=>{let{sectionUUID:n,urlToRemove:a}=t;await v.cancelQueries({queryKey:["articleResults",{frontend_context_uuid:e.frontendContextUUID}],exact:!1}),v.setQueryData(["articleResults",{frontend_context_uuid:e.frontendContextUUID}],e=>e.map(e=>{if(e.backend_uuid===n){var t,i;return{...e,widget_data:null===(t=e.widget_data)||void 0===t?void 0:t.filter(e=>e.url!==a),knowledge_cards:null===(i=e.knowledge_cards)||void 0===i?void 0:i.filter(e=>e.url!==a)}}return e}))},onSettled:()=>{v.invalidateQueries({queryKey:["articleResults",{frontend_context_uuid:e.frontendContextUUID}]})}}),{mutate:K}=(0,i.D)({mutationKey:["toggleEmphasizeSources",e.thread_url_slug],mutationFn:async t=>{let{sectionUUID:n,value:a}=t;return await (0,u.tq)(n,e.rwToken,a)},onMutate:async e=>{let{sectionUUID:n,value:a}=e;await v.cancelQueries({queryKey:["articleResults",{frontend_context_uuid:null==t?void 0:t.frontend_context_uuid}],exact:!1}),v.setQueryData(["articleResults",{frontend_context_uuid:null==t?void 0:t.frontend_context_uuid}],e=>e.map(t=>e.find(e=>e.backend_uuid===n)?{...t,article_info:{...t.article_info,emphasize_sources:a}}:t))}});return{updateArticleSectionTitle:j,updateArticleSectionHeroOffset:w,publishArticleMutation:k,unpublishArticleMutation:D,searchArticleSectionImages:I,generateArticleSectionImage:C,deleteArticle:U,deleteArticleSection:S,updateArticleSectionsLayout:N,updateArticleSectionImage:R,addMediaItemToSectionSelectedImages:T,removeMediaItemFromSectionSelectedImages:M,uploadImageToSectionMediaItems:E,reorderArticleSection:P,searchMediaForQuery:A,searchShoppingForQuery:F,generateReviewSummaryForItem:W,addMediaItemToSection:q,removeWidget:Z,toggleEmphasizeSources:K}}},39294:function(e,t,n){n.d(t,{O:function(){return r}});var a=n(52983),i=n(61061);function r(){let e=(0,i.nO)(),[t,n]=(0,a.useState)(!1);return(0,a.useCallback)((a,i,r,l)=>{e&&!t&&(n(!0),e.emit("update_thread_access",a,i,{read_write_token:r},e=>{n(!1),(null==e?void 0:e.access)!=null&&(null==l||l(null==e?void 0:e.access))}))},[t,e])}},73350:function(e,t,n){n.d(t,{$:function(){return l}});var a=n(97458),i=n(51865),r=n.n(i);n(52983);let l=e=>{let{size:t=16,className:n,...i}=e;return(0,a.jsx)("div",{className:r()("aspect-square shrink-0 animate-spin rounded-full p-[2px]",n),style:{width:t,backgroundImage:"conic-gradient(from 270deg, transparent 0%, currentColor 99%)",mask:"radial-gradient(transparent 0%, transparent ".concat(t/2-2,"px, black ").concat(t/2-2,"px, black) center center")},...i})}}}]);