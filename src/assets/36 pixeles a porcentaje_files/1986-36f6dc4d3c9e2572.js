!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},l=Error().stack;l&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[l]="54731049-7702-4806-a349-719c6c450382",e._sentryDebugIdIdentifier="sentry-dbid-54731049-7702-4806-a349-719c6c450382")}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1986],{74650:function(e,l){l.DF={prefix:"far",iconName:"up-right-from-square",icon:[512,512,["external-link-alt"],"f35d","M304 41c0 10.9 4.3 21.3 12 29L362.1 116 207 271c-9.4 9.4-9.4 24.6 0 33.9s24.6 9.4 33.9 0l155-155L442.1 196c7.7 7.7 18.1 12 29 12c22.6 0 41-18.3 41-41V40c0-22.1-17.9-40-40-40H345c-22.6 0-41 18.3-41 41zm57.9 7H464V150.1L361.9 48zM72 32C32.2 32 0 64.2 0 104V440c0 39.8 32.2 72 72 72H408c39.8 0 72-32.2 72-72V312c0-13.3-10.7-24-24-24s-24 10.7-24 24V440c0 13.3-10.7 24-24 24H72c-13.3 0-24-10.7-24-24V104c0-13.3 10.7-24 24-24H200c13.3 0 24-10.7 24-24s-10.7-24-24-24H72z"]},l.t3=l.DF},62336:function(e,l){l.DF={prefix:"fas",iconName:"chevron-up",icon:[512,512,[],"f077","M233.4 105.4c12.5-12.5 32.8-12.5 45.3 0l192 192c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L256 173.3 86.6 342.6c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3l192-192z"]},l.mT=l.DF},23915:function(e,l,t){t.r(l),t.d(l,{default:function(){return S}});var i=t(97458),n=t(52983),s=t(31737),r=t(86231),a=t.n(r),d=t(13487),u=t(35638),o=t(62309),c=t(46563),m=t(89782),v=t(87552),x=t(11556),h=t(43902),p=t(38474),f=t(51865),g=t.n(f);let y=e=>{var l;let{submit:t,editQueryValue:r,setEditQueryValue:a,setIsEditingQuery:d,isEditingQuery:f,isFirstResult:y}=e,w=(0,s.useTranslations)("shared"),{trackEvent:b}=(0,o.h)(),{isMobileStyle:j,isMobileUserAgent:_}=(0,c.d)(),{isFailed:k,result:N,isReadonly:C,isSnapshotRender:S}=(0,u.T)(),I=null==N?void 0:N.backend_uuid,E=null==N?void 0:N.frontend_context_uuid,F=null==N?void 0:N.query_str,D=(0,n.useCallback)(()=>{if(t){b("confirm edit query click",{entryUUID:I,newQuery:r});let e=(0,m.Mp)();t({rawQuery:r,existingEntryUUID:I,redoSearch:!0,collection:null,newFrontendContextUUID:C?e:null,existingFrontendContextUUID:C?null:E,promptSource:"user",querySource:"edit"})}},[t,b,r,I,E,C]),U=(0,n.useCallback)(()=>{a(null!=F?F:""),d(!1),b("cancel edit query click",{entryUUID:I})},[a,F,d,b,I]),M=(0,n.useCallback)(e=>{v.t.isEnterKeyWithoutShift(e)&&(e.preventDefault(),D())},[D]),R=""===r,T=(null!==(l=null==F?void 0:F.length)&&void 0!==l?l:0)>200;return(0,i.jsx)("div",{className:g()({"my-md md:my-lg":!S,"my-md":S}),children:f?(0,i.jsx)("div",{className:"flex w-full",children:(0,i.jsx)("div",{className:"grow",children:(0,i.jsx)(h.Z,{isMobileUserAgent:_,isMobileStyle:j,onKeyDown:M,autoFocus:!0,size:"large",wrapperClassName:"grow",value:r,onChange:e=>a(e.target.value),inlineEditBlock:(0,i.jsxs)("div",{className:"flex items-center gap-x-xs pl-sm",children:[(0,i.jsx)(p.Z,{text:w("cancel"),size:"small",pill:!0,onClick:U}),(0,i.jsx)(p.Z,{text:w("save"),pill:!0,variant:R?"common":"primary",size:"small",disabled:R,onClick:D})]})})})}):(0,i.jsx)(x.Z,{variant:T?"baseSemi":"entry-title",as:y?"h1":"div",className:g()("whitespace-pre-line break-words [word-break:break-word]",{"whitespace-pre-wrap":T}),children:k?(0,i.jsx)("div",{className:"flex items-center gap-x-sm",children:(0,i.jsx)("span",{children:null!=F?F:"Something went wrong..."})}):F})})};var w=t(79755),b=t(6139),j=t(75004),_=t(25929);let k=a()(()=>Promise.all([t.e(6391),t.e(7640),t.e(8148),t.e(1116),t.e(8107),t.e(6091),t.e(8224)]).then(t.bind(t,78224)).then(e=>e.ThreadContent),{loadableGenerated:{webpack:()=>[78224]},loading:()=>(0,i.jsx)(w.a,{})}),N=a()(()=>Promise.all([t.e(7640),t.e(8107),t.e(485)]).then(t.bind(t,40485)),{loadableGenerated:{webpack:()=>[40485]}}),C=(0,n.forwardRef)((e,l)=>{var t;let{result:r,inFlight:a,showAnimations:v=!1,isLastResult:x=!1,isFirstResult:h=!1,isSnapshotRender:p,idx:f,submit:w,onRelatedButtonClick:C,onTextSelectClick:S,showSurvey:I=!1,onBotStep:E,deleteLast:F,isReadonly:D}=e,{isMobileStyle:U}=(0,c.d)(),{trackEvent:M}=(0,o.h)(),R=(0,n.useRef)(null),T=(0,n.useRef)(a),[q,P]=(0,n.useState)(!1),[Q,V]=(0,n.useState)(null!==(t=null==r?void 0:r.query_str)&&void 0!==t?t:""),A=(0,n.useMemo)(()=>{var e;return r?(0,b.c)(null!==(e=r.text)&&void 0!==e?e:""):[]},[r]),H=(0,s.useTranslations)("shop"),L=(null==r?void 0:r.status)==="failed",Z=(null==r?void 0:r.status)==="pending",z=null!=A&&A.length>0,B=!z||"FINAL"===A[A.length-1].step_type,G=(0,n.useMemo)(()=>r?(0,m.EH)(r):null,[r]),K=(0,n.useMemo)(()=>{var e;return L?[]:null!==(e=null==r?void 0:r.media_items)&&void 0!==e?e:[]},[null==r?void 0:r.media_items,L]),W=!U&&B,J=(0,n.useMemo)(()=>K.filter(e=>"image"===e.medium||"map"===e.medium),[K]);(0,n.useEffect)(()=>{let e=h&&x,l=T.current&&!a;e&&l&&B&&(()=>{let e=setTimeout(()=>{M("engaged",{})},1e4);return()=>{clearTimeout(e)}})(),T.current=a},[a,h,B,x,M]);let O=J.length>0,X=(0,n.useCallback)(e=>{var l,t,i;w({existingEntryUUID:null!==(l=null==r?void 0:r.backend_uuid)&&void 0!==l?l:void 0,newFrontendContextUUID:null,existingFrontendContextUUID:null==r?void 0:r.frontend_context_uuid,deletedUrls:e,rawQuery:null!==(t=null==r?void 0:r.query_str)&&void 0!==t?t:"",existingUuid:null!==(i=null==r?void 0:r.uuid)&&void 0!==i?i:void 0,collection:null,promptSource:"user",querySource:"citation_modal"})},[w,null==r?void 0:r.backend_uuid,null==r?void 0:r.frontend_context_uuid,null==r?void 0:r.query_str,null==r?void 0:r.uuid]);return r?(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{ref:l}),(0,i.jsx)("div",{ref:R}),(0,i.jsx)(u.A,{idx:f,result:r,response:G,inFlight:a,isReadonly:D,isPending:Z,hasSteps:z,isCopilot:z,mediaItems:K,filteredMediaItems:J,isFailed:L,isFinalStep:B,isSnapshotRender:p,isLastResult:x,children:(0,i.jsx)(_.ZP,{className:g()("pb-lg",{"border-b":!x&&!p,"min-h-[54vh]":a&&x&&!p}),children:(0,i.jsxs)("div",{className:p?"":p?O?"md:grid grid-cols-12 gap-md":"":"md:grid grid-cols-12 gap-xl",children:[(0,i.jsxs)("div",{className:p?"":"col-span-8",children:[(0,i.jsx)(y,{setEditQueryValue:V,isFirstResult:h,submit:w,setIsEditingQuery:P,isEditingQuery:q,editQueryValue:Q}),(0,i.jsx)(k,{isEntryInFlight:"pending"===r.status,onRelatedButtonClick:C,onTextSelectClick:S,showSurvey:I,onBotStep:E,deleteLast:F,localRef:R,showAnimations:v,submit:w,submitSourcesCuration:X,setIsEditingQuery:P,isEditingQuery:q,setEditQueryValue:V})]}),(0,i.jsx)("div",{className:p?"":"col-span-4",children:!p&&W&&(0,i.jsx)("div",{className:"sticky top-headerHeight mt-md flex max-h-[calc(100vh_-_74px)] flex-col pt-md",children:(0,i.jsxs)("div",{className:"-mx-md -mt-md min-h-0 flex-1 overflow-y-auto px-md pt-md scrollbar-thin scrollbar-track-transparent scrollbar-thumb-idle dark:scrollbar-thumb-idleDark",children:[r.widget_data&&(0,j.qy)(r.widget_data)&&(0,i.jsx)("div",{className:"pb-sm",children:(0,i.jsx)(d.v,{widgets:r.widget_data,section:null,title:H("overview"),sectionTitle:"",onAddProduct:()=>{}})}),(0,i.jsx)(N,{isStreaming:Z,showAnimations:v,showMediaButtons:r.widget_data&&!(0,j.qy)(r.widget_data)})]})})})]})})})]}):(0,i.jsx)("div",{})});C.displayName="ThreadEntry";var S=C},35638:function(e,l,t){t.d(l,{A:function(){return a},T:function(){return d}});var i=t(97458),n=t(52983),s=t(6139);let r=(0,n.createContext)({result:null,steps:null,plan:null,isPending:!1,mediaItems:[],response:null,isFailed:!1,isReadonly:!1,inFlight:!1,idx:null,isCopilot:!1,filteredMediaItems:[],isLastResult:!1,isFirstResult:!1,hasAnswer:!1,hasSteps:!1,isFinalStep:!1,isSnapshotRender:!1}),a=e=>{let{children:l,result:t,response:a,isReadonly:d,idx:u,inFlight:o,isPending:c,hasSteps:m,isFinalStep:v,isCopilot:x,mediaItems:h,filteredMediaItems:p,isFailed:f,isSnapshotRender:g,isLastResult:y}=e,w=(0,n.useMemo)(()=>{var e;return t?(0,s.c)(null!==(e=t.text)&&void 0!==e?e:""):[]},[t]),b=(0,n.useMemo)(()=>{var e;return null!==(e=null==t?void 0:t.plan)&&void 0!==e?e:null},[t]),j=!!(null==a?void 0:a.answer);return(0,i.jsx)(r.Provider,{value:{isPending:c,hasSteps:m,isFinalStep:v,isCopilot:x,mediaItems:h,filteredMediaItems:p,isFailed:f,steps:w,plan:b,result:t,response:a,isReadonly:d,inFlight:o,idx:u,hasAnswer:j,isSnapshotRender:g,isFirstResult:0===u,isLastResult:y},children:l})},d=()=>{let e=(0,n.useContext)(r);if(!e)throw Error("useThreadEntry must be used within ThreadEntryProvider");return e}},79755:function(e,l,t){t.d(l,{a:function(){return s}});var i=t(97458),n=t(25929);let s=()=>(0,i.jsxs)("div",{className:"animate-pulse",children:[(0,i.jsxs)("div",{className:"flex gap-sm",children:[(0,i.jsx)(n.ZP,{variant:"offset",className:"h-[22px] w-[22px] rounded-full"}),(0,i.jsx)(n.ZP,{variant:"offset",className:"h-[22px] w-[80px] rounded-full"})]}),(0,i.jsx)(n.ZP,{variant:"offset",className:"mt-md h-[80px] rounded-md"})]})}}]);